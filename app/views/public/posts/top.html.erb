<h2>NEW!</h2>
<!--トップページの投稿一覧-->
<div class="container">
  <div class="row">
    <div class="col-md-8">
      <% @posts.each do |post| %>
        <div class="post">
          <div class="post-image">
            <p class="post-image-item">
              <%= link_to public_post_path(post) do %>
                <%= image_tag post.get_image(250,250) %>
              <% end %>
            </p>
            <!--いいねボタン。ログインしているときはいいねできる-->
              <% if user_signed_in? %>
              <div class="like-time">
                <p id="like_buttons_<%= post.id %>">
                  <%= render "public/likes/like", post: post %>
                </p>
              </div>
              <% else %>
              <div class="like-time">
                <%= localize post.created_at, format: :short %>&emsp;
                <i class="far fa-thumbs-up fa-lg"></i><%= post.likes.count %>いいね<!--ログインしていないときはいいねカウントのみ-->
              </div>
              <% end %>
          </div>
          <div class="post-info">
            <p>
              <%= link_to public_user_path(post.user) do %>
                <%= image_tag post.user.get_profile_image(30,30), class: "rounded-circle" %>
                <%= post.user.name %>
              <% end %>
            </p>
            <p><%= post.place %></p>
            <p><%= post.explaination %></p>
            <% post.tags.each do |tag| %>
              <span>#<%= tag.name %></span>
            <% end %>
            <p>
              <%= render 'public/post_comments/counter', post: post %>
              <%= link_to "コメントする", public_post_path(post.id) %>
            </p>
            <div class="edit-delete">
              <% if post.user == current_user %>
                <%= link_to edit_public_post_path(post.id) do %>
                  <i class="far fa-edit fa-lg"></i>
                <% end %>
                <%= link_to public_post_path(post.id), method: :delete, data: { confirm: '本当に削除しますか？' } do %>
                  <i class="far fa-trash-alt fa-lg"></i>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <div class="col-md-4">
      <h3>タグ検索</h3>
      <p>
        <%= form_tag "/", method: :get do %>
          <%= select_tag :tag_id,
             options_from_collection_for_select(Tag.all, :id, :name, params[:tag_id]),
             {
               prompt: 'タグで絞り込み検索',
               onchange: 'submit(this.form);'
             }
          %>
        <% end %>
      </p>
      <p>
        <% if user_signed_in? %>
        <%= render 'public/users/sidebar', user: current_user %>
        <% end %>
      </p>
    </div>
  </div>
</div>
